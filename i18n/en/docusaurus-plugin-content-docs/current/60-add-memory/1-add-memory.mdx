# üëê Add memory to the RAG application

In many Q&A applications we want to allow the user to have a back-and-forth conversation with the LLM, meaning the application needs some sort of "memory" of past questions and answers, and some logic for incorporating those into its current thinking. In this section, you will retrieve chat message history from MongoDB and incorporate it in your RAG application.

Fill in any `<CODE_BLOCK_N>` placeholders and run the cells under the **Step 9: Add memory to the RAG application** section in the notebook to add memory to the chatbot.

The answers for code blocks in this section are as follows:

**CODE_BLOCK_18**

<details>
<summary>Answer</summary>
<div>
```python
history_collection.create_index("session_id")
```
</div>
</details>

**CODE_BLOCK_19**

<details>
<summary>Answer</summary>
<div>
```python
history_collection.insert_one(message)
```
</div>
</details>

**CODE_BLOCK_20**

<details>
<summary>Answer</summary>
<div>
```python
history_collection.find({"session_id": session_id}).sort("timestamp", 1)
```
</div>
</details>

**CODE_BLOCK_21**

<details>
<summary>Answer</summary>
<div>
```python
retrieve_session_history(session_id)
```
</div>
</details>

**CODE_BLOCK_22**

<details>
<summary>Answer</summary>
<div>
```python
{"role": "user", "content": user_query}
```
</div>
</details>

**CODE_BLOCK_23**

<details>
<summary>Answer</summary>
<div>
```python
store_chat_message(session_id, "user", user_query)
store_chat_message(session_id, "assistant", answer)
```
</div>
</details>