# üëê Adicionar mem√≥ria √† aplica√ß√£o RAG

Em muitas aplica√ß√µes de perguntas e respostas, queremos permitir que o usu√°rio tenha uma conversa de ida e volta com o LLM, significando que a aplica√ß√£o precisa de algum tipo de "mem√≥ria" de perguntas e respostas passadas, e alguma l√≥gica para incorporar essas em seu pensamento atual. Nesta se√ß√£o, voc√™ recuperar√° o hist√≥rico de mensagens de chat do MongoDB e o incorporar√° em sua aplica√ß√£o RAG.

Preencha quaisquer espa√ßos reservados `<CODE_BLOCK_N>` e execute as c√©lulas sob a se√ß√£o **Step 9: Add memory to the RAG application** no notebook para adicionar mem√≥ria ao chatbot.

As respostas para os blocos de c√≥digo nesta se√ß√£o s√£o as seguintes:

**CODE_BLOCK_18**

<details>
<summary>Resposta</summary>
<div>
```python
history_collection.create_index("session_id")
```
</div>
</details>

**CODE_BLOCK_19**

<details>
<summary>Resposta</summary>
<div>
```python
history_collection.insert_one(message)
```
</div>
</details>

**CODE_BLOCK_20**

<details>
<summary>Resposta</summary>
<div>
```python
history_collection.find({"session_id": session_id}).sort("timestamp", 1)
```
</div>
</details>

**CODE_BLOCK_21**

<details>
<summary>Resposta</summary>
<div>
```python
retrieve_session_history(session_id)
```
</div>
</details>

**CODE_BLOCK_22**

<details>
<summary>Resposta</summary>
<div>
```python
{"role": "user", "content": user_query}
```
</div>
</details>

**CODE_BLOCK_23**

<details>
<summary>Resposta</summary>
<div>
```python
store_chat_message(session_id, "user", user_query)
store_chat_message(session_id, "assistant", answer)
```
</div>
</details>